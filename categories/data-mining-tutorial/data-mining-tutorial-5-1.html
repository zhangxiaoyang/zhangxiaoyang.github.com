<!doctype html>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="description" content="爱美工的程序员"/>
    <meta name="keywords" content="学习，思考，想法"/>
    <meta name="author" content="zhangxiaoyang"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    <title>zhangxiaoyang.me</title>
    <link rel="shortcut icon" href="/favicon.ico"/>
    <link rel="stylesheet" type="text/css" href="/themes/default/css/style.css"/>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <meta name="google-site-verification" content="Fjy6iUBWNJ0NBNFFzR8ZxFrkCxJ9rvHeBBYPyue-HBw"/>
<link rel="stylesheet" type="text/css" href="/themes/default/css/scrollUp.css"/>
<link rel="stylesheet" type="text/css" href="/themes/default/css/prettify-solarized-dark.css"/>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?661930a9db32b395d0caee1a2c022527";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-46826647-1', 'auto');
  ga('send', 'pageview');
</script>

  </head>
  <body>
    <div id="container">
      <div id="wrap">
        <header id="header">
          <div id="banner" style="background: url(http://ww3.sinaimg.cn/large/005X3nNxjw1epeyfkp54aj30sg0fr0tj.jpg) no-repeat center center; background-size: cover;">
          </div>
          <div id="header-outer" class="outer">
            <div id="header-title" class="inner">
              <div class="logo">
                <img src="https://avatars3.githubusercontent.com/u/2735163?v=3&amp;s=460" alt="Profile Picture">
              </div>
              <div id="title">
                爱美工的程序员
              </div>
              <ul class="my-navigation">
                
                <li>
                  <a href="/index.html" title="Home">
                  <i class="fa fa-home" style="color: #3369e8;"> </i>
                  </a>
                </li>
                
                <li>
                  <a href="/category.html" title="Category">
                  <i class="fa fa-th-large" style="color: #3369e8;"> </i>
                  </a>
                </li>
                
                <li>
                  <a href="/about.html" title="About">
                  <i class="fa fa-user" style="color: #3369e8;"> </i>
                  </a>
                </li>
                
                <li>
                  <a href="http://feed43.com/6303201812741414.xml" title="RSS">
                  <i class="fa fa-rss" style="color: #3369e8;"> </i>
                  </a>
                </li>
                
              </ul>
            </div>
          </div>
          <div id="header-inner" class="">
            <nav id="title-nav" style="display: none;">
              <span id="title-nav-items">
                
                  <a href="/index.html" title="Home">
                    <i class="fa fa-home"></i>
                  </a>
                
                  <a href="/category.html" title="Category">
                    <i class="fa fa-th-large"></i>
                  </a>
                
                  <a href="/about.html" title="About">
                    <i class="fa fa-user"></i>
                  </a>
                
                  <a href="http://feed43.com/6303201812741414.xml" title="RSS">
                    <i class="fa fa-rss"></i>
                  </a>
                
              </span>
            </nav>
            <nav id="sub-nav">
              <a id="nav-search-btn" class="nav-icon" title="Search">
              </a>
            </nav>
            <div id="search-form-wrap">
              <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8"
              class="search-form">
                <input type="search" name="word" maxlength="20" class="search-form-input"
                placeholder="搜索">
                <input type="submit" value="" class="search-form-submit">
                <input name="tn" type="hidden" value="bds">
                <input name="cl" type="hidden" value="3">
                <input name="ct" type="hidden" value="2097152">
                <input type="hidden" name="si" value="zhangxiaoyang.me">
              </form>
            </div>
          </div>
        </header>

<div class="outer">
  <section id="main">
    <article id="data-mining-tutorial/data-mining-tutorial-5-1" class="article article-type-post"
    itemscope="" itemprop="blogPost">
      <div class="article-inner">
        <header class="article-header">
          <h1 itemprop="name">
            <a class="article-title" href="/categories/data-mining-tutorial/data-mining-tutorial-5-1.html">
              数据挖掘自学笔记(5-1)
            </a>
          </h1>
        </header>
        <footer class="article-footer">
          <ul class="article-time-list">
            <li class="article-time-list-item">
              <a class="article-time-list-link" href="/archive.html">
                2013-11-23 01:03:00
              </a>
            </li>
          </ul>
          <br/>
          <ul class="article-category-list">
            <li class="article-category-list-item">
              <a class="article-category-list-link" href="/category.html">
                数据挖掘自学笔记
              </a>
            </li>
          </ul>
          <br/>
          <ul class="article-tag-list">
            
              <li class="article-tag-list-item">
                <a class="article-tag-list-link" href="/tag.html">
                  决策树
                </a>
              </li>
            
              <li class="article-tag-list-item">
                <a class="article-tag-list-link" href="/tag.html">
                  分类
                </a>
              </li>
            
          </ul>
        </footer>
        <div class="article-entry" itemprop="articleBody">
          <div class="article-abstract"><p>什么是关联规则？关联规则就是两个事情经过同时发生，并且在事情A发生的时候往往会发生B，于是我们就有了A=&gt;B这条关联规则，比如谈恋爱=&gt;结婚。我们为什么非老大劲去挖掘关联规则呢？因为关联规则里隐藏着“不能说的秘密”，有些秘密是有价值。还是谈恋爱=&gt;结婚这条规则，就说明了谈恋爱最后基本都结婚了，让我们又相信了爱情，这还没价值吗？？如果是结婚=&gt;谈恋爱，这就没什么意思了。</p>
</div>
<p>关联规则挖掘，挖掘到的是关联规则。分类的挖掘，挖掘到（预测到）的是分类标号。</p>
<h1 id="-classification-">分类（Classification）</h1>
<p>分类预测的是分类标号，什么是分类标号呢？</p>
<p>分类标号是离散值，比如把一个群体分成屌丝、土豪、高富帅三类，分类标号则分别是屌丝、土豪、高富帅。再比如把土豪分为小土豪、大土豪、高级土豪，可以根据月收入来分，5000以下的为小土豪，5000到0000的为大土豪，10000以上的为高级土豪。所以，分类标号需要离散化。</p>
<p>分类是预测的一种，预测的是分类标号，即把没有分类标号的群体分到有分类标号的群体里，也就完成了分类，具体如何分类则需要分类算法。</p>
<p>不管使用什么算法，分类过程主要有两个步骤，如下图表示。</p>
<p><img src="/drafts/categories/data-mining-tutorial/images/分类过程.jpg" alt=""></p>
<h2 id="-decision-tree-">决策树（Decision Tree）</h2>
<p>决策树应该是最最最简单的一个分类算法（老师这么说的，我咋觉得也不太easy呢）。</p>
<p>决策树的过程可以用找对象的例子进行说明。把妹子分成喜欢的和不喜欢的，把喜欢的分成能有对象的和没对象的，把没对象的分成能追上的和不能追上的，可以表示为树的形式，如下图。</p>
<p><img src="/drafts/categories/data-mining-tutorial/images/决策树形式.jpg" alt=""></p>
<p>这就是一棵决策树，也就是说根据这棵树进行决策的制定。其中，每一个内部节点（不是叶子的节点）表示一个属性上的测试，每一个分枝表示一个测试输出，每一个叶子节点表示一个类划分。</p>
<p>可以发现，决策树就是分类规则（分类规则不一定非得是我们一下子能看得懂的规则），或者说决策树就是学习到的模型（映射、函数）。只要有了决策树，再给我们一些新数据，就可以对这些新数据进行分类。问题是如何得到这棵决策树呢？</p>
<p>时光倒流到还没有这棵树的时候，我们只有一些事务记录，如下图。</p>
<p><img src="/drafts/categories/data-mining-tutorial/images/事务记录.jpg" alt=""></p>
<p>原始数据的Name表示姓名，Like表示对其喜欢的程度评分，Mate为当前女生的配偶姓名，Object为追求的简易程度。我们要做的第一步就是对原始数据离散化，得到了预处理后的数据。要知道，决策树是在训练集的基础上学习出来的，所以，我们需要有一个靠谱的训练集，而训练集的格式采用预处理格式的要求。训练集中的Class表示类标号，有Yes类和No类。这样得到决策树后，我们拿未分类的数据进行分类，被分到Yes类的就是我们可以追求的女生（和分类的准确度有关，肯定有分的不合适的）。</p>
<p>通过上面的训练集我们可以得到决策树吗？决策树是一棵树，首先要确定的就是根节点，我们的根节点是哪个属性呢？女神、有对象、好追求？最开始给出的决策树使用的是喜欢吗（也就是女神这个属性），凭什么选这个作为根节点？</p>
<p>所以，就有了决策树的构造算法。只要构造出每个指定位置的节点，就完成了决策树的构造。</p>
<p>如何选择属性？或者说，如何选择当前的节点使用哪个属性进行测试？</p>
<p>所以就有了ID3算法、C4.5算法等。</p>
<h2 id="id3-">ID3算法</h2>
<p>ID3算法使用信息增益的方法来衡量一个属性对于决策的重要性，信息增益越大，属性就容易被优先选择。</p>
<p>如何计算信息增益呢？</p>
<p>对第k个属性计算信息增益：$gain_k(D)= info(D)-info_k(D)$。其中，$info(D)=-\sum_{i=1}^{m} p_i log_2 (p_i)$，$info_k(D)=\sum_{j=1}^{v} \frac{|D_j|}{|D|}info(D_j)$。看到这些公式估计不想再学数据挖掘，坚持坚持，挺住...</p>
<p>info求出来的是熵，为什么要用熵？熵可以表示某个随机变量出现的期望值，进而和信息增益相联系。</p>
<p>看公式容易头疼，还是直接看这个例子吧，依次求解一下各个属性的信息增益，如下图。</p>
<p><img src="/drafts/categories/data-mining-tutorial/images/信息增益.jpg" alt=""></p>
<p>尽管公式比较麻烦，实际求解的时候还是挺简单的。“有对象”的信息增益要大于其它两个属性，所以我们应该把“有对象”的测试作为根节点。之前给出的决策树是不合适的，使用ID3算法得到的决策树如下图。</p>
<p><img src="/drafts/categories/data-mining-tutorial/images/第一次分的决策树.jpg" alt=""></p>
<p>可以看到，经过第一次属性分解（根部的“有对象”属性），可以得到两个测试输出，而比较凑巧的是，左侧和右侧的输出正好全是yes和no。所以，我们无需再进行属性分解了，决策树就构造完了。</p>
<p>什么时候还需要继续进行属性分解呢？如果左侧的表格，Class值有yes和no，就需要继续分解，因为还没有得到明确的决策。属性分解还是使用计算信息增益的方法求解出当前需要分解的属性。</p>
<p>什么时候分解结束呢？有三种情况：第一种就是我们遇到的这种，属性都属于同一类；第二种是没有训练样本；第三种是没有剩余的属性可以分解了（可以看到，随着属性分解，表格会越来越小，列数越来越少），这时候就需要多数表决来确定，如下图。</p>
<p><img src="/drafts/categories/data-mining-tutorial/images/多数表决.jpg" alt=""></p>
<p>注：这里分类的时候只分了yes和no两类，其实可以分成更多的类，而类标号也不一定非得用yes和no，名字随便起啦。所以，决策树也未必一定是二叉树。本例中的Name没有参与到分类中来，因为这仅仅是一个ID。决策树的构建过程其实是一个贪心的过程，OMG，贪心好厉害。</p>
<h2 id="c4-5-">C4.5算法</h2>
<p>ID3有偏向多值属性的缺点，所以就有了C4.5算法。什么是多值属性，比如主键ID，在每条记录中都不同，所以是多值的，ID3就偏向这样的属性。但是这样的偏向对于划分没有意义。</p>
<p>ID3是使用信息增益来选取要进行分裂的属性，C4.5则使用增益率来选取，即具有最大增益率的属性优先分裂。</p>
<p>所以，仅仅是公式不同而已。</p>
<p>$$split\underline{\text{ }}info(D)=-\sum_{j=1}^{v} \frac{D_j}{D}log_2 \frac{D_j}{D}$$</p>
<p>$$gain\underline{\text{ }}radio_k(D)=\frac{gain_k(D)}{split\underline{\text{ }}info_k(D)}$$</p>
<p>至此，我们终于挖掘出来了新的东西——决策树，这棵树可以帮我们分类哦！分类无处不再，尽情想象吧(╯▽╰)</p>
<p>感谢这篇博文：<a href="http://www.cnblogs.com/leoo2sk/archive/2010/09/19/decision-tree.html">http://www.cnblogs.com/leoo2sk/archive/2010/09/19/decision-tree.html</a></p>
<h2 id="-">补充</h2>
<p>得到的决策树往往还需要剪枝，主要是为了避免决策树过分的拟合样本。什么叫做过分拟合样本？就是完全的根据样本得到决策树，完全考虑样本的每一个细节，哪怕样本里有错误决策树也完全的“服从”。</p>
<p>所以需要对决策树进行适当的剪枝，如何剪枝？参考这篇<a href="http://blog.sina.com.cn/s/blog_68ffc7a40100urn3.html">博文</a>。</p>
<p><code>-- EOF --</code></p>

        </div>
        <div id="disqus_thread"></div>
      </div>
    </article>
  </section>
</div>
        <footer id="footer">
          <div class="outer">
            <div id="footer-info" class="inner">
              © 2017 zhangxiaoyang.me
              <br>
              Powered by
              <a href="https://github.com/zhangxiaoyang/fow" target="_blank">
                Fow
              </a>
            </div>
          </div>
        </footer>
      </div>
      <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js" type="text/javascript"></script>
      <script src="/themes/default/js/jquery.scrollUp.min.js" type="text/javascript"></script>
      <script src="/themes/default/js/jquery.transform.js" type="text/javascript"></script>
      <script src="/themes/default/js/menu.js" type="text/javascript"></script>
      <script src="/themes/default/js/script.js" type="text/javascript"></script>
      <script src="/themes/default/js/scrollUp.js" type="text/javascript"></script>
      <script src="/themes/default/js/prettify.js" type="text/javascript"></script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script type="text/javascript">
$(window).load(function(){
  $('pre').addClass('prettyprint linenums');
  prettyPrint();
});
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],        
    inlineMath: [ ['$','$'], ['\\(','\\)'] ],
    displayMath: [ ['$$','$$'], ['\\[','\\]'] ]
  }
});
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script type="text/javascript">
  $('.article-entry img').click(function() {
    window.open($(this).attr('src'), '_blank');
  });
</script>

<script>
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//zhangxiaoyang-me.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
  </body>
</html>

